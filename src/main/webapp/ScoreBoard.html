<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ScoreBoard</title>
    <link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="Style.css">
    <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="http://cdn.datatables.net/1.10.9/js/jquery.dataTables.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="jquery-3.2.1.min.js"></script>
    <script language="javascript">

        var quizName;

        var numberOfPlayers;

        $(document).ready(function() {

            //using the function getParameterByName to set the variables quizName and nickname
            quizName = getParameterByName('quizName');

            document.getElementById("mainWindowHeadline2").innerHTML = "quizname: " + quizName + "";

            showScoreboard();

        });

        function showScoreboard(){
            var placing = 1;

            $.get("rest/quizzes/" + quizName + "/players", function (data) {

                numberOfPlayers = data.length;

                if(data != null) {
                    for (i = 0; i < data.length; i++) {
                        if(data[i] != null) {
                            $("#cont4").append('<div class="row" id="row">'
                                + '<div id="placing" name="quizzes" class="col-sm-4" style="background-color:#ffdccc;">' + placing + '</div>'
                                + '<div id="placing" class="col-sm-4" style="background-color:#ffcbb3;">' + data[i].nickname + '</div>'
                                + '<div if="score" class="col-sm-4" style="background-color:#ffdccc;">' + data[i].score + '</div></div>');
                        placing += 1;
                        }
                    }
                }

            });
        }

        var interval = setInterval(updateLivePanel, 5000)

        function updateLivePanel(){
            for(i= 0; i < numberOfPlayers; i++) {
                $("#row").remove();
            }

            showScoreboard()
        }

        /**
         * Premade function that gets out the nickname and the quizname as parameters in the url.
         *
         * @param name
         * @param url
         * @returns {*}
         */
        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }
    </script>
</head>
<body>
<ul id="topMenu">
    <li id="topMenuOptions"><img alt="logo" id="toplogo" onclick="clickLogo()" src="https://www.imageupload.co.uk/images/2017/10/18/Untitlessssd.png" height="100" width="188"></li>
    <li id="topMenuOptions" class="active"><a href="MainWindow.html">Start quizzing!</a></li>
    <li id="topMenuOptions"><a href="regNewQuiz.html">Create new quiz</a></li>
</ul>
<br>

<div class="container" id="picCont">
    <img id="midlogo" align="middle" src="https://i.imgur.com/XMTa45z.png" alt="Logo" height="150" width="300">
</div>
<br>

<div class="container" id="cont4">
    <h1>Scoreboard</h1>
    <h2 id="mainWindowHeadline2"></h2>
    <br>
    <ul id="futureQuizzes" style="list-style-type:disc">
    </ul>
    <div class="row">
        <div name="quizzes" class="col-sm-4" style="background-color:#ffdccc;"><dt>Placing</dt></div>
        <div class="col-sm-4" style="background-color:#ffcbb3;"><dt>Nickname</dt></div>
        <div class="col-sm-4" style="background-color:#ffdccc;"><dt>Score</dt></div>
    </div>
</div>

</body>
</html>